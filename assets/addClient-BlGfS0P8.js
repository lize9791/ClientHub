import{C as e,a as l}from"./childHeader-B3en3oWs.js";import{_ as a,r as t,a as o,s as d,c as r,b as u,d as n,w as i,e as m,o as c,f as s,u as p,g as _,t as g,h as f,i as h,M as V,j as b,k as y,l as q}from"./index-DFanicNr.js";const U={class:"add-client-container"},v={class:"main-container"},w={class:"client-info-box"},x={class:"left-box"},k={class:"inline-box"},j={key:0,class:"right-box"},C={class:"inline-box"},M={class:"rmb"},O={class:"inline-box"},Y={class:"inline-box"},E=a({__name:"addClient",setup(a){const E=t(!1),H=o({client_name:"",is_transfer:!0,client_email:"",client_phone:"",follow_up_method:[],country:"",remark:"",state:"",origin:"",profit:"",inquiry_date:"",follow_up_date:"",file:[],order_num:"",language:"",client_company:"",product_name:"",product_specifications:"",order_inquiry_date:"",payment_account:"",payment_ratio:null,payment_date:"",production_date:"",export_method:"",order_product_name:"",product_model:"",product_quantity:null,product_unit:"",product_price:null,product_spec:""}),S=o({order_inquiry_date:"",order_num:"",payment_account:"",payment_ratio:null,payment_date:"",production_date:"",export_method:"",order_product_name:"",product_model:"",product_quantity:null,product_unit:"",product_price:null,product_spec:"",profit:null}),$={client_name:[{required:!0,message:"请输入客户姓名",trigger:"change"}],is_transfer:[{required:!0,message:"请选择是否为转接客户",trigger:"change"}],client_email:[{required:!1,message:"请输入邮箱地址",trigger:"change"},{validator:e=>!e||/^[\w.-]+@[\w.-]+\.\w+$/.test(e),message:"邮箱格式不正确",trigger:"blur"}],client_phone:[{required:!1,message:"请输入联系电话",trigger:"change"},{validator:e=>!e||/^\+?[1-9]\d{0,3}[-.\s]?\d{4,14}(?:[-.\s]\d{1,13})?$/.test(e),message:"请输入正确的国际电话号码（示例：+86 13800138000）",trigger:"blur"}],follow_up_method:[{required:!0,message:"请选择跟进方式",trigger:"change"}],country:[{required:!0,message:"请输入或选择国家",trigger:"change"}],remark:[{required:!1}],state:[{required:!0,message:"请选择客户状态",trigger:"change"}],origin:[{required:!0,message:"请选择客户来源",trigger:"change"}],profit:[{validator:e=>void 0===e||""===e||/^\d+(\.\d+)?$/.test(e),message:"利润必须为数字",trigger:"blur"}],inquiry_date:[{required:!0,message:"请选择日期",trigger:"change"}],file:[{required:!1}],order_num:[{required:!0,message:"请输入单号",trigger:"change"}],language:[{required:!0,message:"请选择客户语言",trigger:"change"}],client_company:[{required:!1,message:"请输入客户公司名称",trigger:"change"}],product_name:[{required:!0,message:"请输入产品名称",trigger:"change"}],product_specifications:[{required:!0,message:"请输入产品规格",trigger:"change"}],order_inquiry_date:[{required:!0,message:"请输入询盘日期",trigger:"change"}],payment_account:[{required:!0,message:"请输入收款账号",trigger:"change"}],payment_ratio:[{required:!0,message:"请输入收款比例",trigger:"change"}],payment_date:[{required:!0,message:"请输入收款日期",trigger:"change"}],production_date:[{required:!0,message:"请输入排产日期",trigger:"change"}],export_method:[{required:!0,message:"请输入出口方式",trigger:"change"}],order_product_name:[{required:!0,message:"请输入产品名称",trigger:"change"}],product_model:[{required:!0,message:"请输入产品型号",trigger:"change"}],product_quantity:[{required:!0,message:"请输入产品数量",trigger:"change"}],product_unit:[{required:!0,message:"请输入产品单位",trigger:"change"}],product_price:[{required:!0,message:"请输入产品单价",trigger:"change"}],product_spec:[{required:!0,message:"请输入详细规格描述",trigger:"change"}]},z=Object.entries(e).sort(([,e],[,l])=>e.localeCompare(l,"zh-CN")).map(([e,l])=>({label:l,value:e})),D=[];for(const e in d)D.push({label:d[e].label,value:e});const I=[];for(const e in b)I.push({label:b[e],value:e});const N=[];for(const e in y)N.push({label:y[e],value:e});const R=[];for(const e in q)R.push({label:q[e],value:e});const B=()=>{V.success("重置成功")},A=async({validateResult:l,firstError:a})=>{if(!0===l){const l=Object.keys(S),a=Object.entries(H).filter(([e])=>!l.includes(e)),t={...Object.fromEntries(a),created_at:f().format("YYYY-MM-DD HH:mm:ss+08"),follow_up_method:H.follow_up_method.join(","),country:e[H.country],country_addrev:H.country,inquiry_date:H.inquiry_date+"+08",follow_up_date:H.follow_up_date+"+08"};delete t.file,E.value=!0;const o=await h.insertClient(t);E.value=!1,sessionStorage.setItem("refresh",1),201===o.status&&await V.success("添加成功")}else console.log("Errors: ",l),await V.warning(a)};return(e,a)=>{const t=m("t-input"),o=m("t-form-item"),d=m("t-select"),f=m("t-textarea"),h=m("t-date-picker"),V=m("t-switch"),b=m("t-checkbox-group"),y=m("t-upload"),q=m("t-button"),S=m("t-space"),F=m("t-input-number"),G=m("t-form"),J=m("SimpleBar");return c(),r("div",U,[u(l,{title:"新增客户"}),n("main",v,[u(J,{style:{"max-height":"100%"}},{default:i(()=>[n("div",w,[u(G,{ref:"form",data:H,rules:$,"reset-type":"initial",disabled:E.value,colon:"",onReset:B,onSubmit:A},{default:i(()=>[n("div",x,[u(o,{label:"姓名",name:"client_name"},{default:i(()=>[u(t,{modelValue:H.client_name,"onUpdate:modelValue":a[0]||(a[0]=e=>H.client_name=e),placeholder:"请输入客户姓名"},null,8,["modelValue"])]),_:1}),u(o,{label:"国家",name:"country"},{default:i(()=>[u(d,{modelValue:H.country,"onUpdate:modelValue":a[1]||(a[1]=e=>H.country=e),options:p(z),clearable:"",filterable:"",placeholder:"请选择客户国家"},null,8,["modelValue","options"])]),_:1}),u(o,{label:"产品名称",name:"product_name"},{default:i(()=>[u(t,{modelValue:H.product_name,"onUpdate:modelValue":a[2]||(a[2]=e=>H.product_name=e),placeholder:"请输入产品名称"},null,8,["modelValue"])]),_:1}),u(o,{label:"产品规格",name:"product_specifications"},{default:i(()=>[u(f,{modelValue:H.product_specifications,"onUpdate:modelValue":a[3]||(a[3]=e=>H.product_specifications=e),placeholder:"请输入产品规格",clearable:""},null,8,["modelValue"])]),_:1}),n("div",k,[u(o,{label:"询盘日期",name:"inquiry_date"},{default:i(()=>[u(h,{modelValue:H.inquiry_date,"onUpdate:modelValue":a[4]||(a[4]=e=>H.inquiry_date=e),mode:"date","enable-time-picker":"","allow-input":"",clearable:""},null,8,["modelValue"])]),_:1}),u(o,{label:"客户语言",name:"language"},{default:i(()=>[u(d,{modelValue:H.language,"onUpdate:modelValue":a[5]||(a[5]=e=>H.language=e),options:R,clearable:"",filterable:"",placeholder:"请选择客户语言"},null,8,["modelValue"])]),_:1})]),u(o,{label:"客户公司",name:"client_company"},{default:i(()=>[u(t,{modelValue:H.client_company,"onUpdate:modelValue":a[6]||(a[6]=e=>H.client_company=e),placeholder:"请输入客户公司名称"},null,8,["modelValue"])]),_:1}),u(o,{label:"邮箱",name:"client_email"},{default:i(()=>[u(t,{modelValue:H.client_email,"onUpdate:modelValue":a[7]||(a[7]=e=>H.client_email=e),placeholder:"请输入客户邮箱"},null,8,["modelValue"])]),_:1}),u(o,{label:"电话",name:"client_phone"},{default:i(()=>[u(t,{modelValue:H.client_phone,"onUpdate:modelValue":a[8]||(a[8]=e=>H.client_phone=e),placeholder:"请输入客户电话"},null,8,["modelValue"])]),_:1}),u(o,{label:"状态",name:"state"},{default:i(()=>[u(d,{modelValue:H.state,"onUpdate:modelValue":a[9]||(a[9]=e=>H.state=e),options:D,clearable:""},null,8,["modelValue"])]),_:1}),u(o,{label:"询盘来源",name:"origin"},{default:i(()=>[u(d,{modelValue:H.origin,"onUpdate:modelValue":a[10]||(a[10]=e=>H.origin=e),options:I,clearable:""},null,8,["modelValue"])]),_:1}),u(o,{label:"是否转交",name:"is_transfer"},{default:i(()=>[u(V,{modelValue:H.is_transfer,"onUpdate:modelValue":a[11]||(a[11]=e=>H.is_transfer=e),label:["是","否"]},null,8,["modelValue"])]),_:1}),u(o,{label:"跟进方式",name:"follow_up_method"},{default:i(()=>[u(b,{modelValue:H.follow_up_method,"onUpdate:modelValue":a[12]||(a[12]=e=>H.follow_up_method=e),options:N},null,8,["modelValue"])]),_:1}),u(o,{label:"跟进日期",name:"follow_up_date"},{default:i(()=>[u(h,{modelValue:H.follow_up_date,"onUpdate:modelValue":a[13]||(a[13]=e=>H.follow_up_date=e),mode:"date","enable-time-picker":"","allow-input":"",clearable:""},null,8,["modelValue"])]),_:1}),u(o,{label:"备注",name:"remark"},{default:i(()=>[u(f,{modelValue:H.remark,"onUpdate:modelValue":a[14]||(a[14]=e=>H.remark=e),placeholder:"客户备注",clearable:""},null,8,["modelValue"])]),_:1}),u(o,{label:"相关文件",name:"file"},{default:i(()=>[u(y,{modelValue:H.file,"onUpdate:modelValue":a[15]||(a[15]=e=>H.file=e),action:"/",theme:"image",tips:"请选择单张图片文件上传",accept:"image/*"},null,8,["modelValue"])]),_:1}),u(o,{class:"btn-box"},{default:i(()=>[u(S,{size:"small",class:"form-btn-space"},{default:i(()=>[u(q,{theme:"default",variant:"base",type:"reset",style:{width:"100px"}},{default:i(()=>[...a[30]||(a[30]=[_(" 重置 ",-1)])]),_:1}),u(q,{theme:"primary",type:"submit",style:{width:"100%"}},{default:i(()=>[...a[31]||(a[31]=[_("提交",-1)])]),_:1})]),_:1})]),_:1})]),[3,4].includes(Number(H.state))?(c(),r("div",j,[u(o,{label:"单号",name:"order_num"},{default:i(()=>[u(t,{modelValue:H.order_num,"onUpdate:modelValue":a[16]||(a[16]=e=>H.order_num=e),placeholder:"请输入单号"},null,8,["modelValue"])]),_:1}),n("div",C,[u(o,{label:"利润(美金)",name:"profit"},{default:i(()=>[u(F,{modelValue:H.profit,"onUpdate:modelValue":a[17]||(a[17]=e=>H.profit=e),theme:"normal",placeholder:"请输入利润"},null,8,["modelValue"])]),_:1}),a[32]||(a[32]=n("div",{class:"exchange-rate"},"汇率: 7",-1)),n("div",M,"￥"+g(Math.round(7*(H.profit||0)*1e3)/1e3),1)]),u(o,{label:"询盘日期",name:"order_inquiry_date"},{default:i(()=>[u(h,{modelValue:H.order_inquiry_date,"onUpdate:modelValue":a[18]||(a[18]=e=>H.order_inquiry_date=e),placeholder:"请选择询盘日期"},null,8,["modelValue"])]),_:1}),u(o,{label:"收款账号",name:"payment_account"},{default:i(()=>[u(t,{modelValue:H.payment_account,"onUpdate:modelValue":a[19]||(a[19]=e=>H.payment_account=e),placeholder:"请输入收款账号"},null,8,["modelValue"])]),_:1}),u(o,{label:"收款比例",name:"payment_ratio"},{default:i(()=>[u(F,{modelValue:H.payment_ratio,"onUpdate:modelValue":a[20]||(a[20]=e=>H.payment_ratio=e),placeholder:"请输入收款比例",min:"0",max:"100",theme:"normal"},null,8,["modelValue"])]),_:1}),n("div",O,[u(o,{label:"收款日期",name:"payment_date"},{default:i(()=>[u(h,{modelValue:H.payment_date,"onUpdate:modelValue":a[21]||(a[21]=e=>H.payment_date=e),placeholder:"请选择收款日期"},null,8,["modelValue"])]),_:1}),u(o,{label:"排产日期",name:"production_date"},{default:i(()=>[u(h,{modelValue:H.production_date,"onUpdate:modelValue":a[22]||(a[22]=e=>H.production_date=e),placeholder:"请选择排产日期"},null,8,["modelValue"])]),_:1})]),u(o,{label:"出口方式",name:"export_method"},{default:i(()=>[u(t,{modelValue:H.export_method,"onUpdate:modelValue":a[23]||(a[23]=e=>H.export_method=e),placeholder:"请输入出口方式"},null,8,["modelValue"])]),_:1}),u(o,{label:"产品名称",name:"order_product_name"},{default:i(()=>[u(t,{modelValue:H.order_product_name,"onUpdate:modelValue":a[24]||(a[24]=e=>H.order_product_name=e),placeholder:"请输入产品名称"},null,8,["modelValue"])]),_:1}),u(o,{label:"产品型号",name:"product_model"},{default:i(()=>[u(t,{modelValue:H.product_model,"onUpdate:modelValue":a[25]||(a[25]=e=>H.product_model=e),placeholder:"请输入产品型号"},null,8,["modelValue"])]),_:1}),n("div",Y,[u(o,{label:"产品数量",name:"product_quantity"},{default:i(()=>[u(F,{modelValue:H.product_quantity,"onUpdate:modelValue":a[26]||(a[26]=e=>H.product_quantity=e),placeholder:"请输入产品数量",min:"0",theme:"normal"},null,8,["modelValue"])]),_:1}),u(o,{label:"产品单价",name:"product_price"},{default:i(()=>[u(F,{modelValue:H.product_price,"onUpdate:modelValue":a[27]||(a[27]=e=>H.product_price=e),placeholder:"请输入产品单价",min:"0",theme:"normal"},null,8,["modelValue"])]),_:1})]),u(o,{label:"产品单位",name:"product_unit"},{default:i(()=>[u(t,{modelValue:H.product_unit,"onUpdate:modelValue":a[28]||(a[28]=e=>H.product_unit=e),placeholder:"请输入产品单位"},null,8,["modelValue"])]),_:1}),u(o,{label:"详细描述",name:"product_spec"},{default:i(()=>[u(f,{modelValue:H.product_spec,"onUpdate:modelValue":a[29]||(a[29]=e=>H.product_spec=e),placeholder:"请输入规格的详细描述",clearable:""},null,8,["modelValue"])]),_:1})])):s("",!0)]),_:1},8,["data","disabled"])])]),_:1})])])}}},[["__scopeId","data-v-7ea4e57d"]]);export{E as default};
